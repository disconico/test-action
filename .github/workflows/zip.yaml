name: Zip src folder and add to repo

on:
  pull_request:
    types: [closed]
    branches:
      - main

jobs:
  build:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Zip src folder
      run: |
        echo "Creating new src.zip from src folder... ðŸ”’"
        mkdir -p build
        zip -r -X build/src.zip src
        echo "Zip created ðŸš€"

    - name: Commit and push
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add build/src.zip
        git commit -m "chore: automatically zipped src folder and added to build directory"
        git push
